<app-secondary-nav
  title="Liste des Collectes"
  backRoute="/volunteer-space"
  backLabel="Mon espace"
  [showLogout]="true"
  [showRefresh]="true"
  (refreshClick)="loadCollects()">
</app-secondary-nav>

<div class="home-container">
  <div class="hero">
    <h1>BIENVENU.E.S SUR AL'ACTION</h1>
    <p class="subtitle">Al'action est une association qui sensibilise aux ramassages des d√©chets sauvages</p>
  </div>
</div>

<div class="container">
  <div class="header">
    <h2>Liste des collectes</h2>
  </div>

  @if (loading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Chargement des collectes...</p>
    </div>
  }

  @if (errorMessage && !loading) {
    <div class="alert alert-danger">
      {{ errorMessage }}
    </div>
  }

  @if (!loading && !errorMessage) {
    <div>
      <div class="stats-bar">
        <div class="stat-item">
          <span class="stat-value">{{ totalCollects }}</span>
          <span class="stat-label">collecte(s)</span>
        </div>
      </div>

      @if (collects.length === 0) {
        <div class="empty-state">
          <p>üì¶ Aucune collecte enregistr√©e</p>
        </div>
      }

      @if (collects.length > 0) {
        <div class="collects-grid">
          @for (collect of collects; track collect) {
            <div
              class="collect-card"
              (click)="viewCollectDetails(collect.id)"
              >

              <div class="collect-header">
                <div class="collect-date">
                  üìÖ {{ formatDate(collect.collectionDate) }}
                </div>
                <span
                  class="status-badge"
                  [ngClass]="getStatusBadgeClass(collect.status)"
                  >
                  {{ getStatusLabel(collect.status) }}
                </span>
              </div>

              <div class="collect-city">
                <strong>üìç {{ collect.city?.name || 'Ville inconnue' }}</strong>
              </div>

              <div class="waste-items">
                @for (item of collect.wasteCollectionItems; track item) {
                  <div
                    class="waste-item"
                    >
                    <span class="waste-type">
                      {{ item.wasteType?.name || 'D√©chet inconnu' }}
                    </span>
                    <span class="waste-quantity">{{ item.quantity }} kg</span>
                  </div>
                }
              </div>

              <div class="collect-total">
                <strong>Total : {{ getTotalWeight(collect) }} kg</strong>
              </div>

              <div class="collect-actions">
                <button
                  class="btn btn-danger btn-sm"
                  (click)="deleteCollect(collect.id, $event)"
                  >
                  üóëÔ∏è Supprimer
                </button>
              </div>
            </div>
          }
        </div>
      }
    </div>
  }
</div>
